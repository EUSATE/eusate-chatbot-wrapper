var EusateChatbot=function(){"use strict";const t="https://unpkg.com/@tailwindcss/browser@4",e="https://cdn.jsdelivr.net/gh/eusate/eusate-chatbot-core@latest/src/assets/icomoon/style.css",i="https://eusate-chatbot-core.vercel.app",s="EUSATE_INIT",n="EUSATE_READY",a="EUSATE_AUTH_ERROR",r="CLOSE_CHAT",o="OPEN_CHAT",h="EUSATE_DESTROY",c="[EUSATE SDK] API Key is required for initialization",l="[EUSATE SDK] Error:",d="[EUSATE SDK] Initialization timeout",m="[EUSATE SDK] Failed to load chat iframe",u="[EUSATE SDK] Not initialized yet. Call init() first.",f="[EUSATE SDK] Already destroyed",p="[Eusate SDK] Already initialized. Call destroy() first to reinitialize.";var b;!function(t){t.INIT="init",t.AUTH="auth"}(b||(b={}));class y{constructor(c){this.chatInitialized=!1,this.isChatOpen=!1,this.isDestroyed=!1,this.fabClickHandler=null,this.messageHandler=null,this.initTimeout=null,this.init=()=>{try{this.setupContainer(),this.setupFabIframe(),this.setupChatIframe(),this.setupMessageHandlers(),document.body?document.body.appendChild(this.container):document.addEventListener("DOMContentLoaded",()=>{document.body.appendChild(this.container)}),this.loadFabButton()}catch(t){this.handleError(new Error(`${l}, ${t.message}`))}},this.setupContainer=()=>{this.container.id="eusate-chat-widget-container",this.container.style.cssText="\n      position: fixed;\n      bottom: 20px;\n      right: 20px;\n      z-index: 10000;\n    ",this.container.setAttribute("data-eusate-widget","true")},this.setupFabIframe=()=>{this.fabIframe.id="eusate-chat-widget-fab",this.fabIframe.style.cssText="\n      position: relative;\n      z-index: 1;\n      height: 80px;\n      width: 80px;\n      border: none;\n      background: transparent;\n      box-shadow: 0px 40px 72px -12px #10192824;\n    ",this.fabIframe.setAttribute("title","Open chat support"),this.fabIframe.setAttribute("aria-label","Open chat support"),this.container.appendChild(this.fabIframe)},this.setupChatIframe=()=>{this.chatIframe.id="eusate-chat-widget",this.chatIframe.src=i,this.chatIframe.style.cssText="\n      position: absolute;\n      bottom: 100px;\n      right: 0px;\n      width: 390px;\n      height: 576px;\n      transform: scale(0);\n      opacity: 0;\n      transition-property: transform, translate, scale, rotate, opacity;\n      transition-timing-function:  cubic-bezier(0.4, 0, 0.2, 1);\n      transition-duration: 500ms;\n      border: none;\n      transform-origin: bottom right;\n      box-shadow: 0px 40px 72px -12px #10192824;\n    ",this.chatIframe.setAttribute("title","Eusate chat support"),this.chatIframe.setAttribute("aria-hidden","true"),this.chatIframe.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups"),this.chatIframe.onload=()=>this.handleChatIframeLoad(),this.chatIframe.onerror=()=>this.handleIframeError(),this.container.appendChild(this.chatIframe)},this.handleChatIframeLoad=()=>{setTimeout(()=>{var t;const e={type:s,data:{apiKey:this.apiKey},timestamp:Date.now()};null===(t=this.chatIframe.contentWindow)||void 0===t||t.postMessage(e,i)},1e3),this.initTimeout=setTimeout(()=>{this.isInitialized||this.handleError(new Error(d))},1e4)},this.handleIframeError=()=>{this.handleError(new Error(m))},this.setupMessageHandlers=()=>{this.messageHandler=t=>{if(t.origin===new URL(i).origin)switch(t.data.type){case n:this.handleReady();break;case a:this.chatInitialized=!1,this.handleError(new Error(t.data.message||"Authentication failed"));break;case r:this.close()}},window.addEventListener("message",this.messageHandler,!1)},this.handleReady=()=>{var t;this.chatInitialized=!0,this.initTimeout&&(clearTimeout(this.initTimeout),this.initTimeout=null),this.fab&&(this.fab.disabled=!1),null===(t=this.onReady)||void 0===t||t.call(this)},this.handleError=t=>{var e;console.error(t.message),this.initTimeout&&(clearTimeout(this.initTimeout),this.initTimeout=null),this.destroy(),null===(e=this.onError)||void 0===e||e.call(this,t)},this.loadFabButton=()=>{const i=this.fabIframe.contentDocument;if(!i)return void setTimeout(()=>this.loadFabButton(),100);const s=i.head||i.createElement("head"),n=i.createElement("link");n.href=e,n.rel="stylesheet",s.appendChild(n);const a=i.createElement("script");a.src=t,s.appendChild(a),i.head||i.documentElement.appendChild(s);const r=i.body||i.createElement("body");r.style.cssText="\n      margin: 0;\n      padding: 0;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      width: 100%;\n      height: 100%;\n      overflow: hidden;\n      border: none;\n      outline: none;\n    ",this.fab.id="eusate-messenger-fab-btn",this.fab.style.cssText="\n      width: 80px;\n      height: 80px;\n      background-color: #0a0a0a;\n      border-radius: 50%;\n      cursor: pointer;\n      color: white;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      transform: scale(0.95);\n      transition: transform 0.2s ease;\n      border: none;\n      outline: none;\n      ",this.fab.disabled=!0,this.fab.onmouseenter=()=>{this.fab.disabled||(this.fab.style.transform="scale(1)")},this.fab.onmouseleave=()=>{this.fab.disabled||(this.fab.style.transform="scale(0.95)")},this.fab.onmousedown=()=>{this.fab.disabled||(this.fab.style.transform="scale(0.8)")},this.fabIcon.id="button-icon",this.fabIcon.className="icon-eusate text-4xl",this.fab.appendChild(this.fabIcon),r.appendChild(this.fab),i.body||i.documentElement.appendChild(r),this.fabClickHandler=()=>this.toggle(),this.fab.addEventListener("click",this.fabClickHandler,!1)},this.isInitialized=()=>this.chatInitialized,this.isOpen=()=>this.isChatOpen,this.open=()=>{var t;this.chatInitialized?this.isChatOpen||(this.isChatOpen=!0,this.chatIframe.style.transform="scale(1)",this.chatIframe.style.opacity="1",this.fabIcon.classList.add("icon-chevron-down"),this.fabIcon.classList.remove("icon-eusate"),this.fab.style.transform="scale(0.8)",null===(t=this.chatIframe.contentWindow)||void 0===t||t.postMessage({type:o,timestamp:Date.now()},i)):console.warn(u)},this.close=()=>{var t;this.isChatOpen&&(this.isChatOpen=!1,this.chatIframe.style.transform="scale(0)",this.chatIframe.style.opacity="0",this.fabIcon.classList.add("icon-eusate"),this.fabIcon.classList.remove("icon-chevron-down"),this.fab.style.transform="scale(0.95)",null===(t=this.chatIframe.contentWindow)||void 0===t||t.postMessage({type:r,timestamp:Date.now()},i))},this.toggle=()=>{this.chatInitialized?"scale(1)"===this.chatIframe.style.transform?this.close():this.open():console.warn(u)},this.destroy=()=>{this.isDestroyed?console.warn(f):(this.isChatOpen&&this.close(),this.initTimeout&&(clearTimeout(this.initTimeout),this.initTimeout=null),this.messageHandler&&(window.removeEventListener("message",this.messageHandler,!1),this.messageHandler=null),this.fab&&this.fabClickHandler&&(this.fab.removeEventListener("click",this.fabClickHandler,!1),this.fabClickHandler=null),this.chatIframe.contentWindow&&this.chatIframe.contentWindow.postMessage({type:h,timestamp:Date.now()},i),this.container.remove(),y.instance=null,this.isDestroyed=!0,console.log("EusateMessenger instance destroyed successfully"))},this.apiKey=null==c?void 0:c.apiKey.trim(),this.onReady=c.onReady,this.onError=c.onError,this.container=document.createElement("div"),this.fabIframe=document.createElement("iframe"),this.chatIframe=document.createElement("iframe"),this.fabIcon=document.createElement("span"),this.fab=document.createElement("button"),this.init()}static getInstance(t){if(y.instance)return t&&console.warn(p),y.instance;if(!t)throw new Error(c);if(!t.apiKey||"string"!=typeof t.apiKey||""===t.apiKey.trim())throw new Error(c);return y.instance=new y(t),y.instance}}y.instance=null;const I={init:t=>{try{const e="string"==typeof t?{apiKey:t}:t;y.getInstance(e)}catch(t){throw console.error(l,t),t}},open:()=>{try{y.getInstance().open()}catch(t){console.error(l,t)}},close:()=>{try{y.getInstance().close()}catch(t){console.error(l,t)}},destroy:()=>{try{y.getInstance().destroy()}catch(t){console.error(l,t)}},isInitialized:()=>{try{return y.getInstance().isInitialized()}catch(t){return!1}},isOpen:()=>{try{return y.getInstance().isOpen()}catch(t){return!1}}};return window.Eusate=I,I}();
